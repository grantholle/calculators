define(["jquery"],function(e){var o=function(){var o,t,i=e("body"),r=e("div.vehicle-cost"),l=e("div.operating-costs"),p=e("div.lifetime-costs"),s=e("input#competitor-vehicle-price"),a=e("input#propane-vehicle-cost"),n=e("input#conversion-cost"),h=e("div#average-mpg-slider"),d=e("div#price-per-gallon"),c=e("input#type-of-vehicle"),v={},f={vehicleLifeMiles:2e5,lifetimePmVisits:{propane:40,gasoline:40,diesel:50},pmCost:{propane:50,gasoline:50,diesel:110},airFilters:{propane:200,diesel:260,gasoline:200},fuelFilters:{propane:210,gasoline:210,diesel:4525}},u={prop:{},other:{}},C={app:"onroad"},m=function(){i.on("refreshCalculation",g)},g=function(e){"undefined"==typeof e&&(e="diesel"),o=e,t=e.charAt(0).toUpperCase()+e.slice(1),V(),$(),M(),i.trigger("refreshWaypoint")},V=function(){u.other.vehicleCost=parseInt(P(s.val()),10),"diesel"==o?u.prop.vehicleCost=parseInt(P(a.val()),10):u.prop.vehicleCost=u.other.vehicleCost+parseInt(P(n.val()),10),r.find("strong.other").html(s.val()),r.find("span.prop").html("$"+F(u.prop.vehicleCost)),r.find("strong.other").html("$"+F(u.other.vehicleCost))},$=function(){var e=parseFloat(P(d.val()[0])),t=parseFloat(P(d.val()[1])),i=parseFloat(h.val()[1]),r=parseFloat(h.val()[0]),p=f.vehicleLifeMiles/r,s=f.vehicleLifeMiles/i;u.prop.fuelCostsLife=p*e,u.other.fuelCostsLife=s*t,u.prop.pmCosts=f.lifetimePmVisits.propane*f.pmCost.propane,u.other.pmCosts=f.lifetimePmVisits[o]*f.pmCost[o],u.prop.addCosts=f.airFilters.propane+f.fuelFilters.propane,u.other.addCosts=f.airFilters[o]+f.fuelFilters[o],l.find("div.fuel-costs span.prop").html("$"+F(Math.round(u.prop.fuelCostsLife))),l.find("div.fuel-costs strong.other").html("$"+F(Math.round(u.other.fuelCostsLife))),l.find("div.parts span.prop").html("$"+F(u.prop.pmCosts)),l.find("div.parts strong.other").html("$"+F(u.other.pmCosts)),l.find("div.additional span.prop").html("$"+F(u.prop.addCosts)),l.find("div.additional strong.other").html("$"+F(u.other.addCosts))},M=function(){var e=u.other,o=u.prop;u.other.perVehicle=e.vehicleCost+e.fuelCostsLife+e.pmCosts+e.addCosts,u.prop.perVehicle=o.vehicleCost+o.fuelCostsLife+o.pmCosts+o.addCosts,u.other.perMile=u.other.perVehicle/f.vehicleLifeMiles,u.prop.perMile=u.prop.perVehicle/f.vehicleLifeMiles,p.find("div.vehicle strong.other").html("$"+F(Math.round(u.other.perVehicle))),p.find("div.vehicle span.prop").html("$"+F(Math.round(u.prop.perVehicle))),p.find("div.mile strong.other").html("$"+u.other.perMile.toFixed(2)),p.find("div.mile span.prop").html("$"+u.prop.perMile.toFixed(2))},b=function(){"Diesel"==t?(propaneVehicleLabel="Propane Autogas Vehicle Cost",propaneVehicleValue=a.val()):"Gasoline"==t&&(propaneVehicleLabel="Propane Autogas Conversion or Option Cost",propaneVehicleValue=n.val()),C.input=[{label:"Compare Propane Autogas with",value:t},{label:"Type of Vehicle",value:c.val()},{label:propaneVehicleLabel,value:propaneVehicleValue},{label:t+" Vehicle Cost",value:s.val()},{label:"Propane Average MPG",value:h.val()[0]},{label:t+" Average MPG",value:h.val()[1]},{label:"Propane Price per Gallon",value:d.val()[0]},{label:t+" Price per Gallon",value:d.val()[1]}]},L=function(){C.output=[{label:"Vehicle Cost",body:[["Propane",t],["$"+F(u.prop.vehicleCost),F(u.other.vehicleCost)]]},{label:"Lifetime Operating Costs",body:[["","Fuel Costs","Parts and Maintenance","Additional Costs"],["Propane","$"+F(Math.round(u.prop.fuelCostsLife)),"$"+F(u.prop.pmCosts),"$"+F(u.prop.addCosts)],[t,"$"+F(Math.round(u.other.fuelCostsLife)),"$"+F(u.other.pmCosts),"$"+F(u.other.addCosts)]]},{label:"Lifetime Ownership Costs",body:[["","Per Vehicle","Per Mile Average"],["Propane","$"+F(Math.round(u.prop.perVehicle)),p.find("div.mile span.prop").html()],[t,"$"+F(Math.round(u.other.perVehicle)),p.find("div.mile strong.other").html()]]}]},P=function(e){return e.replace("$","").replace(",","")},F=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")};return v.refresh=g,v.results=function(){return b(),L(),C},m(),v}();return o});